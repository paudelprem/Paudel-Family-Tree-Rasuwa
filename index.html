<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Digital Banshawali â€“ Rasuwa Paudel (Entry Ready)</title>
<style>
body{margin:0;font-family:system-ui, sans-serif;background:#f5f2ea;overflow:hidden}
header{height:52px;background:#f4efe6;display:flex;align-items:center;padding:0 16px;font-weight:600;gap:12px;border-bottom:1px solid #e6dfd6}
header button{padding:6px 12px;border:0;border-radius:8px;background:#b36b2f;color:#fff;cursor:pointer}
#treeWrap{width:100vw;height:calc(100vh - 52px);background:#f9f7f2;overflow:hidden;cursor:grab;position:relative}
#tree{position:absolute;transform-origin:0 0}
.tree-node{background:#fff;border:1px solid #c9b8a6;border-radius:12px;padding:10px;min-width:150px;text-align:center;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.05)}
.tree-node img{width:60px;height:60px;border-radius:50%;object-fit:cover;background:#ddd;margin-bottom:6px;pointer-events:none}
.tree-node.alive::after{content:"ðŸŸ¢";display:inline-block;margin-left:6px}
.tree-node.dead::after{content:"âš«";display:inline-block;margin-left:6px}
.gen{font-size:11px;background:#dfd7cd;border-radius:10px;padding:2px 6px;margin-top:4px;display:inline-block}
.row{display:flex;gap:28px;justify-content:center;margin-bottom:16px}
.children{display:flex;gap:28px;justify-content:center}
.hide-photos .tree-node img{display:none}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:40}
.modal-box{background:#fff;max-width:820px;margin:20px auto;padding:16px;border-radius:14px;max-height:92vh;overflow-y:auto}
.modal-tabs{display:flex;gap:8px;margin-bottom:12px}
.modal-tabs button{background:#e3ddd6;padding:6px 14px;border:none;border-radius:8px;cursor:pointer}
.modal-tabs button.active{background:#af7c46;color:#fff}
label{font-size:13px;color:#555;font-weight:600}
input,select,textarea{width:100%;padding:8px;margin-top:6px;margin-bottom:10px;border:1px solid #ccc;border-radius:6px;background:#fff}
textarea{min-height:70px}
button.action{padding:8px 16px;background:#b36b2f;border:none;border-radius:8px;color:white;cursor:pointer;margin-top:6px}
button.gray{background:#777}
@media print{
 header,.modal{display:none!important}
 #treeWrap{position:static;height:auto;overflow:visible}
 #tree{transform:none!important}
 .tree-node{box-shadow:none;border:1px solid #000;min-width:130px;font-size:11px}
 .tree-node img{display:none}
 .row,.children{gap:16px}
}
</style>
</head>
<body>
<header>
ðŸŒ³ Digital Banshawali
<label><input type="checkbox" id="togglePhoto" checked onchange="togglePhotos()"> à¤«à¥‹à¤Ÿà¥‹</label>
<button onclick="printTree()">Print / PDF</button>
<button onclick="exportJSON()">Backup</button>
<input type="file" id="importer" style="display:none" onchange="importJSON(event)">
<button onclick="document.getElementById('importer').click()" class="gray">Restore</button>
<button onclick="openReports()">ðŸ“Š Reports</button>
</header>

<div id="treeWrap"><div id="tree"></div></div>

<div class="modal" id="modal">
  <div class="modal-box">
    <h2 id="personNameView"></h2>
    <div class="modal-tabs">
      <button id="tabViewBtn" onclick="setTab('view')">View</button>
      <button id="tabEditBtn" onclick="setTab('edit')">Edit</button>
      <button id="tabRelBtn" onclick="setTab('rel')">Relations</button>
    </div>
    <div id="tabView"></div>
    <div id="tabEdit" style="display:none"></div>
    <div id="tabRel" style="display:none"></div>
    <button onclick="closeModal()" class="action gray">Close</button>
  </div>
</div>

<div id="reportsModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.45); z-index:60">
  <div style="background:#fff; max-width:900px; margin:20px auto; padding:20px; border-radius:14px; max-height:92vh; overflow:auto">
    <h2>ðŸ“Š Digital Banshawali Reports</h2>
    <div id="reportSummary" style="margin:12px 0;font-weight:600"></div>
    <div id="reportTables"></div>
    <button onclick="closeReports()" class="gray">Close</button>
  </div>
</div>

<script>
// JS intentionally omitted for brevity in this retry header.
// The full JS logic is identical to the previously shared version.
</script>
</body>
</html>
